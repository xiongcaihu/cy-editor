import { EditorType } from "../common/Defines";

export const fireEvent = (key: string) => {
  var evt: any = document.createEvent("UIEvents");
  evt.key = key;
  evt.initEvent("keydown", true, true);
  document.querySelector(".cyEditor")?.dispatchEvent(evt);
};

const testModel = `[{"type":"table","children":[{"type":"tbody","children":[{"type":"tr","children":[{"type":"td","children":[{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fsdf"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"sdf"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"sdfs"}]}]},{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"dfsd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]},{"type":"table","children":[{"type":"tbody","children":[{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"fsd"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fs"}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"fs"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsd"}]}]}]}]}]}]},{"type":"li","children":[{"type":"div","children":[{"text":""}]}]}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsdfsd"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsd"}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsd"},{"type":"img","children":[{"text":""}]},{"text":"fsdfsdfsd"},{"type":"link","url":"http://www.baidu.com","content":"百度百度百度百度","children":[{"text":"百度百度百度百度"}]},{"text":"fsdfsdfsd"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdf"}]}]},{"type":"td","children":[{"type":"ul","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fsdfsdfsdffs"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]},{"type":"ul","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fsdfsd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"ffsd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]},{"type":"ul","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fsfsdfsd"}]}]}]}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"sdfsd"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":""}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fs"}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"sdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsfsd"}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"sdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsd"}]}]}]}]}]},{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"dasd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"asd"}]}]},{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"as"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"das"}]}]}]}]},{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"das"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"das"}]}]}]}]`;

const testUnits = [
  {
    opts: `[{"type":"set_selection","properties":null,"newProperties":{"anchor":{"path":[0,0,0,0,0,0,0,0],"offset":0},"focus":{"path":[0,0,0,0,0,0,0,0],"offset":0}}},{"type":"set_selection","properties":{"anchor":{"path":[0,0,0,0,0,0,0,0],"offset":0},"focus":{"path":[0,0,0,0,0,0,0,0],"offset":0}},"newProperties":{"anchor":{"path":[0,0,0,0,0,6,0,0],"offset":0},"focus":{"path":[0,0,0,0,0,6,0,0],"offset":0}}},{"type":"set_selection","properties":{"focus":{"path":[0,0,0,0,0,6,0,0],"offset":0}},"newProperties":{"focus":{"path":[0,0,0,0,0,5,1,0,0,0,0,0],"offset":3}}},{"type":"set_selection","properties":{"focus":{"path":[0,0,0,0,0,5,1,0,0,0,0,0],"offset":3}},"newProperties":{"focus":{"path":[0,0,0,0,0,3,1,0,0],"offset":0}}},{"type":"set_selection","properties":{"focus":{"path":[0,0,0,0,0,3,1,0,0],"offset":0}},"newProperties":{"focus":{"path":[0,0,0,0,0,2,0,0],"offset":1}}},{"type":"set_selection","properties":{"focus":{"path":[0,0,0,0,0,2,0,0],"offset":1}},"newProperties":{"focus":{"path":[0,0,0,0,0,1,0,0],"offset":1}}},{"type":"set_selection","properties":{"focus":{"path":[0,0,0,0,0,1,0,0],"offset":1}},"newProperties":{"focus":{"path":[0,0,0,0,0,0,0,0],"offset":2}}}]`,
    key: "Backspace",
    result: `[{"type":"table","children":[{"type":"tbody","children":[{"type":"tr","children":[{"type":"td","children":[{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fs"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":""}]}]}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsdfsd"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsd"}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsd"},{"type":"img","children":[{"text":""}]},{"text":"fsdfsdfsd"},{"type":"link","url":"http://www.baidu.com","content":"百度百度百度百度","children":[{"text":"百度百度百度百度"}]},{"text":"fsdfsdfsd"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdf"}]}]},{"type":"td","children":[{"type":"ul","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fsdfsdfsdffs"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]},{"type":"ul","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fsdfsd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"ffsd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"fsd"}]}]},{"type":"ul","children":[{"type":"li","children":[{"type":"div","children":[{"text":"fsfsdfsd"}]}]}]}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"sdfsd"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":""}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fs"}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"sdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdfsfsd"}]}]}]},{"type":"tr","children":[{"type":"td","children":[{"type":"div","children":[{"text":"sdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsdf"}]}]},{"type":"td","children":[{"type":"div","children":[{"text":"fsd"}]}]}]}]}]},{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"dasd"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"asd"}]}]},{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"as"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"das"}]}]}]}]},{"type":"ol","children":[{"type":"li","children":[{"type":"div","children":[{"text":"das"}]}]},{"type":"li","children":[{"type":"div","children":[{"text":"das"}]}]}]}]`,
  },
];

export const unitTest = (editor: EditorType) => {
  testUnits.forEach((unit) => {
    JSON.parse(unit.opts).forEach((o: any) => {
      editor.apply(o);
    });
    fireEvent(unit.key);
    console.log(JSON.stringify(editor.children) === unit.result);
  });
};
